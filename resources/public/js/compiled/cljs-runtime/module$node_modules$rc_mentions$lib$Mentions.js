shadow$provide.module$node_modules$rc_mentions$lib$Mentions=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault").default;module=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard").default;Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _extends2=global(require("module$node_modules$$babel$runtime$helpers$extends")),_objectSpread2=global(require("module$node_modules$$babel$runtime$helpers$objectSpread2")),
_slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_objectWithoutProperties2=global(require("module$node_modules$$babel$runtime$helpers$objectWithoutProperties")),_classnames=global(require("module$node_modules$classnames$index")),_rcInput=require("module$node_modules$rc_input$lib$index"),_rcTextarea=global(require("module$node_modules$rc_textarea$lib$index")),_toArray=global(require("module$node_modules$rc_util$lib$Children$toArray")),_useMergedState5=global(require("module$node_modules$rc_util$lib$hooks$useMergedState")),
_KeyCode=global(require("module$node_modules$rc_util$lib$KeyCode")),_warning=global(require("module$node_modules$rc_util$lib$warning")),_react=module(require("module$node_modules$react$index")),_useEffectState=global(require("module$node_modules$rc_mentions$lib$hooks$useEffectState")),_KeywordTrigger=global(require("module$node_modules$rc_mentions$lib$KeywordTrigger")),_MentionsContext=global(require("module$node_modules$rc_mentions$lib$MentionsContext"));global=global(require("module$node_modules$rc_mentions$lib$Option"));
var _util=require("module$node_modules$rc_mentions$lib$util"),_excluded="prefixCls className style prefix split notFoundContent value defaultValue children options open allowClear silent validateSearch filterOption onChange onKeyDown onKeyUp onPressEnter onSearch onSelect onFocus onBlur transitionName placement direction getPopupContainer dropdownClassName rows visible onPopupScroll".split(" "),_excluded2="suffix prefixCls defaultValue value allowClear onChange classNames className disabled onClear".split(" "),
InternalMentions=(0,_react.forwardRef)(function(props,ref){var prefixCls=props.prefixCls,className=props.className,style=props.style,_props$prefix=props.prefix,prefix=void 0===_props$prefix?"@":_props$prefix;_props$prefix=props.split;var split=void 0===_props$prefix?" ":_props$prefix;_props$prefix=props.notFoundContent;_props$prefix=void 0===_props$prefix?"Not Found":_props$prefix;var value=props.value,defaultValue=props.defaultValue,children=props.children,options=props.options,open=props.open,silent=
props.silent,_props$validateSearch=props.validateSearch,validateSearch=void 0===_props$validateSearch?_util.validateSearch:_props$validateSearch;_props$validateSearch=props.filterOption;var filterOption=void 0===_props$validateSearch?_util.filterOption:_props$validateSearch,onChange=props.onChange,onKeyDown=props.onKeyDown,onKeyUp=props.onKeyUp,onPressEnter=props.onPressEnter,onSearch=props.onSearch,onSelect=props.onSelect,onFocus=props.onFocus,onBlur=props.onBlur;_props$validateSearch=props.transitionName;
var placement=props.placement,direction=props.direction,getPopupContainer=props.getPopupContainer,dropdownClassName=props.dropdownClassName,_props$rows=props.rows;_props$rows=void 0===_props$rows?1:_props$rows;var onPopupScroll=props.onPopupScroll;props=(0,_objectWithoutProperties2.default)(props,_excluded);var mergedPrefix=(0,_react.useMemo)(function(){return Array.isArray(prefix)?prefix:[prefix]},[prefix]),containerRef=(0,_react.useRef)(null),textareaRef=(0,_react.useRef)(null),measureRef=(0,_react.useRef)(null),
getTextArea=function(){var _textareaRef$current;return null===(_textareaRef$current=textareaRef.current)||void 0===_textareaRef$current||null===(_textareaRef$current=_textareaRef$current.resizableTextArea)||void 0===_textareaRef$current?void 0:_textareaRef$current.textArea};_react.default.useImperativeHandle(ref,function(){var _textareaRef$current4;return{focus:function(){var _textareaRef$current2;return null===(_textareaRef$current2=textareaRef.current)||void 0===_textareaRef$current2?void 0:_textareaRef$current2.focus()},
blur:function(){var _textareaRef$current3;return null===(_textareaRef$current3=textareaRef.current)||void 0===_textareaRef$current3?void 0:_textareaRef$current3.blur()},textarea:null===(_textareaRef$current4=textareaRef.current)||void 0===_textareaRef$current4||null===(_textareaRef$current4=_textareaRef$current4.resizableTextArea)||void 0===_textareaRef$current4?void 0:_textareaRef$current4.textArea,nativeElement:containerRef.current}});ref=(0,_react.useState)(!1);ref=(0,_slicedToArray2.default)(ref,
2);var measuring=ref[0],setMeasuring=ref[1];ref=(0,_react.useState)("");ref=(0,_slicedToArray2.default)(ref,2);var measureText=ref[0],setMeasureText=ref[1];ref=(0,_react.useState)("");ref=(0,_slicedToArray2.default)(ref,2);var measurePrefix=ref[0],setMeasurePrefix=ref[1];ref=(0,_react.useState)(0);ref=(0,_slicedToArray2.default)(ref,2);var measureLocation=ref[0],setMeasureLocation=ref[1];ref=(0,_react.useState)(0);ref=(0,_slicedToArray2.default)(ref,2);var activeIndex=ref[0],setActiveIndex=ref[1];
ref=(0,_react.useState)(!1);ref=(0,_slicedToArray2.default)(ref,2);var isFocus=ref[0],setIsFocus=ref[1];value=(0,_useMergedState5.default)("",{defaultValue,value});value=(0,_slicedToArray2.default)(value,2);var mergedValue=value[0],setMergedValue=value[1];(0,_react.useEffect)(function(){measuring&&measureRef.current&&(measureRef.current.scrollTop=getTextArea().scrollTop)},[measuring]);value=_react.default.useMemo(function(){if(open){(0,_warning.default)(!1,"`open` of Mentions is only used for debug usage. Do not use in you production.");
for(var i=0;i<mergedPrefix.length;i+=1){var curPrefix=mergedPrefix[i],index=mergedValue.lastIndexOf(curPrefix);if(0<=index)return[!0,"",curPrefix,index]}}return[measuring,measureText,measurePrefix,measureLocation]},[open,measuring,mergedPrefix,mergedValue,measureText,measurePrefix,measureLocation]);value=(0,_slicedToArray2.default)(value,4);var mergedMeasuring=value[0],mergedMeasureText=value[1],mergedMeasurePrefix=value[2],mergedMeasureLocation=value[3],getOptions=_react.default.useCallback(function(targetMeasureText){return(options&&
0<options.length?options.map(function(item){var _item$key;return(0,_objectSpread2.default)((0,_objectSpread2.default)({},item),{},{key:null!==(_item$key=null===item||void 0===item?void 0:item.key)&&void 0!==_item$key?_item$key:item.value})}):(0,_toArray.default)(children).map(function(_ref){var optionProps=_ref.props;_ref=_ref.key;return(0,_objectSpread2.default)((0,_objectSpread2.default)({},optionProps),{},{label:optionProps.children,key:_ref||optionProps.value})})).filter(function(option){return!1===
filterOption?!0:filterOption(targetMeasureText,option)})},[children,options,filterOption]),mergedOptions=_react.default.useMemo(function(){return getOptions(mergedMeasureText)},[getOptions,mergedMeasureText]),onSelectionEffect=(0,_useEffectState.default)(),stopMeasure=function(callback){setMeasuring(!1);setMeasureLocation(0);setMeasureText("");onSelectionEffect(callback)},triggerChange=function(nextValue){setMergedValue(nextValue);null===onChange||void 0===onChange||onChange(nextValue)},selectOption=
function(option){var _getTextArea,_option$value=option.value;_option$value=(0,_util.replaceWithMeasure)(mergedValue,{measureLocation:mergedMeasureLocation,targetText:void 0===_option$value?"":_option$value,prefix:mergedMeasurePrefix,selectionStart:null===(_getTextArea=getTextArea())||void 0===_getTextArea?void 0:_getTextArea.selectionStart,split});var selectionLocation=_option$value.selectionLocation;triggerChange(_option$value.text);stopMeasure(function(){(0,_util.setInputSelection)(getTextArea(),
selectionLocation)});null===onSelect||void 0===onSelect||onSelect(option,mergedMeasurePrefix)},focusRef=(0,_react.useRef)(),onInternalFocus=function(event){window.clearTimeout(focusRef.current);!isFocus&&event&&onFocus&&onFocus(event);setIsFocus(!0)},onInternalBlur=function(event){focusRef.current=window.setTimeout(function(){setIsFocus(!1);stopMeasure();null===onBlur||void 0===onBlur||onBlur(event)},0)};value=function(){onInternalFocus()};defaultValue=function(){onInternalBlur()};ref=function(event){null===
onPopupScroll||void 0===onPopupScroll||onPopupScroll(event)};return _react.default.createElement("div",{className:(0,_classnames.default)(prefixCls,className),style,ref:containerRef},_react.default.createElement(_rcTextarea.default,(0,_extends2.default)({ref:textareaRef,value:mergedValue},props,{rows:_props$rows,onChange:function(_ref2){triggerChange(_ref2.target.value)},onKeyDown:function(event){var which=event.which;null===onKeyDown||void 0===onKeyDown||onKeyDown(event);if(mergedMeasuring)if(which===
_KeyCode.default.UP||which===_KeyCode.default.DOWN){var optionLen=mergedOptions.length;setActiveIndex((activeIndex+(which===_KeyCode.default.UP?-1:1)+optionLen)%optionLen);event.preventDefault()}else which===_KeyCode.default.ESC?stopMeasure():which===_KeyCode.default.ENTER&&(event.preventDefault(),silent||(mergedOptions.length?selectOption(mergedOptions[activeIndex]):stopMeasure()))},onKeyUp:function(event){var key=event.key,which=event.which,selectionStartText=(0,_util.getBeforeSelectionText)(event.target),
_getLastMeasureIndex=(0,_util.getLastMeasureIndex)(selectionStartText,mergedPrefix),measureIndex=_getLastMeasureIndex.location;_getLastMeasureIndex=_getLastMeasureIndex.prefix;null===onKeyUp||void 0===onKeyUp||onKeyUp(event);if(-1===[_KeyCode.default.ESC,_KeyCode.default.UP,_KeyCode.default.DOWN,_KeyCode.default.ENTER].indexOf(which))if(-1!==measureIndex){event=selectionStartText.slice(measureIndex+_getLastMeasureIndex.length);selectionStartText=validateSearch(event,split);var matchOption=!!getOptions(event).length;
if(selectionStartText){if(key===_getLastMeasureIndex||"Shift"===key||which===_KeyCode.default.ALT||"AltGraph"===key||mergedMeasuring||event!==mergedMeasureText&&matchOption)setMeasuring(!0),setMeasureText(event),setMeasurePrefix(_getLastMeasureIndex),setMeasureLocation(measureIndex),setActiveIndex(0)}else mergedMeasuring&&stopMeasure();onSearch&&selectionStartText&&onSearch(event,_getLastMeasureIndex)}else mergedMeasuring&&stopMeasure()},onPressEnter:function(event){!mergedMeasuring&&onPressEnter&&
onPressEnter(event)},onFocus:onInternalFocus,onBlur:onInternalBlur})),mergedMeasuring&&_react.default.createElement("div",{ref:measureRef,className:"".concat(prefixCls,"-measure")},mergedValue.slice(0,mergedMeasureLocation),_react.default.createElement(_MentionsContext.default.Provider,{value:{notFoundContent:_props$prefix,activeIndex,setActiveIndex,selectOption,onFocus:value,onBlur:defaultValue,onScroll:ref}},_react.default.createElement(_KeywordTrigger.default,{prefixCls,transitionName:_props$validateSearch,
placement,direction,options:mergedOptions,visible:!0,getPopupContainer,dropdownClassName},_react.default.createElement("span",null,mergedMeasurePrefix))),mergedValue.slice(mergedMeasureLocation+mergedMeasurePrefix.length)))});require=(0,_react.forwardRef)(function(_ref3,ref){var suffix=_ref3.suffix,_ref3$prefixCls=_ref3.prefixCls;_ref3$prefixCls=void 0===_ref3$prefixCls?"rc-mentions":_ref3$prefixCls;var defaultValue=_ref3.defaultValue,customValue=_ref3.value,allowClear=_ref3.allowClear,onChange=_ref3.onChange,
classes=_ref3.classNames,className=_ref3.className,disabled=_ref3.disabled,onClear=_ref3.onClear;_ref3=(0,_objectWithoutProperties2.default)(_ref3,_excluded2);var holderRef=(0,_react.useRef)(null),mentionRef=(0,_react.useRef)(null);(0,_react.useImperativeHandle)(ref,function(){var _holderRef$current,_mentionRef$current;return(0,_objectSpread2.default)((0,_objectSpread2.default)({},mentionRef.current),{},{nativeElement:(null===(_holderRef$current=holderRef.current)||void 0===_holderRef$current?void 0:
_holderRef$current.nativeElement)||(null===(_mentionRef$current=mentionRef.current)||void 0===_mentionRef$current?void 0:_mentionRef$current.nativeElement)})});ref=(0,_useMergedState5.default)("",{defaultValue,value:customValue});ref=(0,_slicedToArray2.default)(ref,2);var setMergedValue=ref[1],triggerChange=function(currentValue){setMergedValue(currentValue);null===onChange||void 0===onChange||onChange(currentValue)};return _react.default.createElement(_rcInput.BaseInput,{suffix,prefixCls:_ref3$prefixCls,
value:ref[0],allowClear,handleReset:function(){triggerChange("")},className,classNames:classes,disabled,ref:holderRef,onClear},_react.default.createElement(InternalMentions,(0,_extends2.default)({className:null===classes||void 0===classes?void 0:classes.mentions,prefixCls:_ref3$prefixCls,ref:mentionRef,onChange:triggerChange,disabled},_ref3)))});require.Option=global.default;exports.default=require}
//# sourceMappingURL=module$node_modules$rc_mentions$lib$Mentions.js.map
