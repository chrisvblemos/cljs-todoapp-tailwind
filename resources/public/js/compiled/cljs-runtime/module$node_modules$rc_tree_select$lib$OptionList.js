shadow$provide.module$node_modules$rc_tree_select$lib$OptionList=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard").default;module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault").default;Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _extends2=module(require("module$node_modules$$babel$runtime$helpers$extends")),_createForOfIteratorHelper2=module(require("module$node_modules$$babel$runtime$helpers$createForOfIteratorHelper")),
_toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_slicedToArray2=module(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_rcSelect=require("module$node_modules$rc_select$lib$index"),_rcTree=global(require("module$node_modules$rc_tree$lib$index")),_KeyCode=module(require("module$node_modules$rc_util$lib$KeyCode")),_useMemo=module(require("module$node_modules$rc_util$lib$hooks$useMemo")),React=global(require("module$node_modules$react$index")),
_LegacyContext=module(require("module$node_modules$rc_tree_select$lib$LegacyContext")),_TreeSelectContext=module(require("module$node_modules$rc_tree_select$lib$TreeSelectContext")),_valueUtil=require("module$node_modules$rc_tree_select$lib$utils$valueUtil"),_rcUtil=require("module$node_modules$rc_util$lib$index"),HIDDEN_STYLE={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0};require=React.forwardRef(function(_,ref){function getDisabledWithCache(node){node=
node[fieldNames.value];if(!disabledCache.has(node)){var entity=valueEntities.get(node);0!==(entity.children||[]).length?(entity=entity.children.filter(function(childTreeNode){return!childTreeNode.node.disabled&&!childTreeNode.node.disableCheckbox&&!checkedKeys.includes(childTreeNode.node[fieldNames.value])}).length,disabledCache.set(node,entity>leftMaxCount)):disabledCache.set(node,!1)}return disabledCache.get(node)}var _useBaseProps=(0,_rcSelect.useBaseProps)();_=_useBaseProps.prefixCls;var multiple=
_useBaseProps.multiple,searchValue=_useBaseProps.searchValue,toggleOpen=_useBaseProps.toggleOpen,open=_useBaseProps.open,notFoundContent=_useBaseProps.notFoundContent,_React$useContext=React.useContext(_TreeSelectContext.default);_useBaseProps=_React$useContext.virtual;var listHeight=_React$useContext.listHeight,listItemHeight=_React$useContext.listItemHeight,listItemScrollOffset=_React$useContext.listItemScrollOffset,treeData=_React$useContext.treeData,fieldNames=_React$useContext.fieldNames,onSelect=
_React$useContext.onSelect,dropdownMatchSelectWidth=_React$useContext.dropdownMatchSelectWidth,treeExpandAction=_React$useContext.treeExpandAction,treeTitleRender=_React$useContext.treeTitleRender,onPopupScroll=_React$useContext.onPopupScroll,leftMaxCount=_React$useContext.leftMaxCount,leafCountOnly=_React$useContext.leafCountOnly,valueEntities=_React$useContext.valueEntities,_React$useContext2=React.useContext(_LegacyContext.default),checkable=_React$useContext2.checkable,checkedKeys=_React$useContext2.checkedKeys,
halfCheckedKeys=_React$useContext2.halfCheckedKeys,treeExpandedKeys=_React$useContext2.treeExpandedKeys;_React$useContext=_React$useContext2.treeDefaultExpandAll;var treeDefaultExpandedKeys=_React$useContext2.treeDefaultExpandedKeys,onTreeExpand=_React$useContext2.onTreeExpand,treeIcon=_React$useContext2.treeIcon,showTreeIcon=_React$useContext2.showTreeIcon,switcherIcon=_React$useContext2.switcherIcon,treeLine=_React$useContext2.treeLine,treeNodeFilterProp=_React$useContext2.treeNodeFilterProp,loadData=
_React$useContext2.loadData,treeLoadedKeys=_React$useContext2.treeLoadedKeys,treeMotion=_React$useContext2.treeMotion,onTreeLoad=_React$useContext2.onTreeLoad,keyEntities=_React$useContext2.keyEntities,treeRef=React.useRef(),memoTreeData=(0,_useMemo.default)(function(){return treeData},[open,treeData],function(prev,next){return next[0]&&prev[1]!==next[1]});_React$useContext2=React.useMemo(function(){return checkable?{checked:checkedKeys,halfChecked:halfCheckedKeys}:null},[checkable,checkedKeys,halfCheckedKeys]);
React.useEffect(function(){if(open&&!multiple&&checkedKeys.length){var _treeRef$current;null===(_treeRef$current=treeRef.current)||void 0===_treeRef$current||_treeRef$current.scrollTo({key:checkedKeys[0]})}},[open]);var onListMouseDown=function(event){event.preventDefault()},onInternalSelect=function(__,info){__=info.node;checkable&&(0,_valueUtil.isCheckDisabled)(__)||(onSelect(__.key,{selected:!checkedKeys.includes(__.key)}),multiple||toggleOpen(!1))};treeDefaultExpandedKeys=React.useState(treeDefaultExpandedKeys);
treeDefaultExpandedKeys=(0,_slicedToArray2.default)(treeDefaultExpandedKeys,2);var expandedKeys=treeDefaultExpandedKeys[0],setExpandedKeys=treeDefaultExpandedKeys[1];treeDefaultExpandedKeys=React.useState(null);treeDefaultExpandedKeys=(0,_slicedToArray2.default)(treeDefaultExpandedKeys,2);var searchExpandedKeys=treeDefaultExpandedKeys[0],setSearchExpandedKeys=treeDefaultExpandedKeys[1];treeDefaultExpandedKeys=React.useMemo(function(){return treeExpandedKeys?(0,_toConsumableArray2.default)(treeExpandedKeys):
searchValue?searchExpandedKeys:expandedKeys},[expandedKeys,searchExpandedKeys,treeExpandedKeys,searchValue]);var lowerSearchValue=String(searchValue).toLowerCase(),filterTreeNode=function(treeNode){return lowerSearchValue?String(treeNode[treeNodeFilterProp]).toLowerCase().includes(lowerSearchValue):!1};React.useEffect(function(){searchValue&&setSearchExpandedKeys((0,_valueUtil.getAllKeys)(treeData,fieldNames))},[searchValue]);var _React$useState5=React.useState(function(){return new Map});_React$useState5=
(0,_slicedToArray2.default)(_React$useState5,2);var disabledCache=_React$useState5[0],setDisabledCache=_React$useState5[1];React.useEffect(function(){leftMaxCount&&setDisabledCache(new Map)},[leftMaxCount]);var nodeDisabled=(0,_rcUtil.useEvent)(function(node){return checkedKeys.includes(node[fieldNames.value])||null===leftMaxCount?!1:0>=leftMaxCount?!0:leafCountOnly&&leftMaxCount?getDisabledWithCache(node):!1}),getFirstMatchingNode=function getFirstMatchingNode(nodes){nodes=(0,_createForOfIteratorHelper2.default)(nodes);
var _step;try{for(nodes.s();!(_step=nodes.n()).done;){var node=_step.value;if(!node.disabled&&!1!==node.selectable){if(searchValue){if(filterTreeNode(node))return node}else return node;if(node[fieldNames.children]){var matchInChildren=getFirstMatchingNode(node[fieldNames.children]);if(matchInChildren)return matchInChildren}}}}catch(err){nodes.e(err)}finally{nodes.f()}return null};_React$useState5=React.useState(null);_React$useState5=(0,_slicedToArray2.default)(_React$useState5,2);var activeKey=_React$useState5[0],
setActiveKey=_React$useState5[1],activeEntity=keyEntities[activeKey];React.useEffect(function(){if(open){var nextActiveKey=multiple||!checkedKeys.length||searchValue?(nextActiveKey=getFirstMatchingNode(memoTreeData))?nextActiveKey[fieldNames.value]:null:checkedKeys[0];setActiveKey(nextActiveKey)}},[open,searchValue]);React.useImperativeHandle(ref,function(){var _treeRef$current2;return{scrollTo:null===(_treeRef$current2=treeRef.current)||void 0===_treeRef$current2?void 0:_treeRef$current2.scrollTo,
onKeyDown:function(event){var _treeRef$current3;switch(event.which){case _KeyCode.default.UP:case _KeyCode.default.DOWN:case _KeyCode.default.LEFT:case _KeyCode.default.RIGHT:null===(_treeRef$current3=treeRef.current)||void 0===_treeRef$current3||_treeRef$current3.onKeyDown(event);break;case _KeyCode.default.ENTER:if(activeEntity){event=nodeDisabled(activeEntity.node);_treeRef$current3=(null===activeEntity||void 0===activeEntity?void 0:activeEntity.node)||{};var value=_treeRef$current3.value,disabled=
_treeRef$current3.disabled;!1===_treeRef$current3.selectable||disabled||event||onInternalSelect(null,{node:{key:activeKey},selected:!checkedKeys.includes(value)})}break;case _KeyCode.default.ESC:toggleOpen(!1)}},onKeyUp:function(){}}});ref=(0,_useMemo.default)(function(){return searchValue?!1:!0},[searchValue,treeExpandedKeys||expandedKeys],function(_ref2,_ref3){_ref2=(0,_slicedToArray2.default)(_ref2,1)[0];var _ref5=(0,_slicedToArray2.default)(_ref3,2);_ref3=_ref5[0];_ref5=_ref5[1];return _ref2!==
_ref3&&!(!_ref3&&!_ref5)})?loadData:null;if(0===memoTreeData.length)return React.createElement("div",{role:"listbox",className:"".concat(_,"-empty"),onMouseDown:onListMouseDown},notFoundContent);notFoundContent={fieldNames};treeLoadedKeys&&(notFoundContent.loadedKeys=treeLoadedKeys);treeDefaultExpandedKeys&&(notFoundContent.expandedKeys=treeDefaultExpandedKeys);return React.createElement("div",{onMouseDown:onListMouseDown},activeEntity&&open&&React.createElement("span",{style:HIDDEN_STYLE,"aria-live":"assertive"},
activeEntity.node.value),React.createElement(_rcTree.UnstableContext.Provider,{value:{nodeDisabled}},React.createElement(_rcTree.default,(0,_extends2.default)({ref:treeRef,focusable:!1,prefixCls:"".concat(_,"-tree"),treeData:memoTreeData,height:listHeight,itemHeight:listItemHeight,itemScrollOffset:listItemScrollOffset,virtual:!1!==_useBaseProps&&!1!==dropdownMatchSelectWidth,multiple,icon:treeIcon,showIcon:showTreeIcon,switcherIcon,showLine:treeLine,loadData:ref,motion:treeMotion,activeKey,checkable,
checkStrictly:!0,checkedKeys:_React$useContext2,selectedKeys:checkable?[]:checkedKeys,defaultExpandAll:_React$useContext,titleRender:treeTitleRender},notFoundContent,{onActiveChange:setActiveKey,onSelect:onInternalSelect,onCheck:onInternalSelect,onExpand:function(keys){setExpandedKeys(keys);setSearchExpandedKeys(keys);onTreeExpand&&onTreeExpand(keys)},onLoad:onTreeLoad,filterTreeNode,expandAction:treeExpandAction,onScroll:onPopupScroll}))))});require.displayName="OptionList";exports.default=require}
//# sourceMappingURL=module$node_modules$rc_tree_select$lib$OptionList.js.map
