shadow$provide.module$node_modules$rc_field_form$lib$utils$validateUtil=function(global,require,module,exports){function replaceMessage(template,kv){return template.replace(/\\?\$\{\w+\}/g,function(str){if(str.startsWith("\\"))return str.slice(1);str=str.slice(2,-1);return kv[str]})}function validateRule(_x,_x2,_x3,_x4,_x5){return _validateRule.apply(this,arguments)}function _validateRule(){_validateRule=(0,_asyncToGenerator2.default)((0,_regeneratorRuntime2.default)().mark(function _callee2(name,
value,rule,options,messageVariables){var cloneRule,originValidator,subRuleField,validator,messages,result,subResults,kv,fillVariableResult;return(0,_regeneratorRuntime2.default)().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return cloneRule=(0,_objectSpread2.default)({},rule),delete cloneRule.ruleIndex,AsyncValidator.warning=function(){},cloneRule.validator&&(originValidator=cloneRule.validator,cloneRule.validator=function(){try{return originValidator.apply(void 0,
arguments)}catch(error){return console.error(error),Promise.reject(CODE_LOGIC_ERROR)}}),subRuleField=null,cloneRule&&"array"===cloneRule.type&&cloneRule.defaultField&&(subRuleField=cloneRule.defaultField,delete cloneRule.defaultField),validator=new AsyncValidator((0,_defineProperty2.default)({},name,[cloneRule])),messages=(0,_set.merge)(_messages.defaultValidateMessages,options.validateMessages),validator.messages(messages),result=[],_context2.prev=10,_context2.next=13,Promise.resolve(validator.validate((0,_defineProperty2.default)({},
name,value),(0,_objectSpread2.default)({},options)));case 13:_context2.next=18;break;case 15:_context2.prev=15,_context2.t0=_context2["catch"](10),_context2.t0.errors&&(result=_context2.t0.errors.map(function(_ref4,index){_ref4=_ref4.message;_ref4=_ref4===CODE_LOGIC_ERROR?messages.default:_ref4;return React.isValidElement(_ref4)?React.cloneElement(_ref4,{key:"error_".concat(index)}):_ref4}));case 18:if(result.length||!subRuleField){_context2.next=23;break}_context2.next=21;return Promise.all(value.map(function(subValue,
i){return validateRule("".concat(name,".").concat(i),subValue,subRuleField,options,messageVariables)}));case 21:return subResults=_context2.sent,_context2.abrupt("return",subResults.reduce(function(prev,errors){return[].concat((0,_toConsumableArray2.default)(prev),(0,_toConsumableArray2.default)(errors))},[]));case 23:return kv=(0,_objectSpread2.default)((0,_objectSpread2.default)({},rule),{},{name,enum:(rule.enum||[]).join(", ")},messageVariables),fillVariableResult=result.map(function(error){return"string"===
typeof error?replaceMessage(error,kv):error}),_context2.abrupt("return",fillVariableResult);case 26:case "end":return _context2.stop()}},_callee2,null,[[10,15]])}));return _validateRule.apply(this,arguments)}function finishOnAllFailed(_x8){return _finishOnAllFailed.apply(this,arguments)}function _finishOnAllFailed(){_finishOnAllFailed=(0,_asyncToGenerator2.default)((0,_regeneratorRuntime2.default)().mark(function _callee3(rulePromises){return(0,_regeneratorRuntime2.default)().wrap(function(_context3){for(;;)switch(_context3.prev=
_context3.next){case 0:return _context3.abrupt("return",Promise.all(rulePromises).then(function(errorsList){var _ref5;return(_ref5=[]).concat.apply(_ref5,(0,_toConsumableArray2.default)(errorsList))}));case 1:case "end":return _context3.stop()}},_callee3)}));return _finishOnAllFailed.apply(this,arguments)}function finishOnFirstFailed(_x9){return _finishOnFirstFailed.apply(this,arguments)}function _finishOnFirstFailed(){_finishOnFirstFailed=(0,_asyncToGenerator2.default)((0,_regeneratorRuntime2.default)().mark(function _callee4(rulePromises){var count;
return(0,_regeneratorRuntime2.default)().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return count=0,_context4.abrupt("return",new Promise(function(resolve){rulePromises.forEach(function(promise){promise.then(function(ruleError){ruleError.errors.length&&resolve([ruleError]);count+=1;count===rulePromises.length&&resolve([])})})}));case 2:case "end":return _context4.stop()}},_callee4)}));return _finishOnFirstFailed.apply(this,arguments)}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard").default;
module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault").default;Object.defineProperty(exports,"__esModule",{value:!0});exports.validateRules=function(namePath,value,rules,options,validateFirst,messageVariables){var name=namePath.join("."),filledRules=rules.map(function(currentRule,ruleIndex){var originValidatorFunc=currentRule.validator;currentRule=(0,_objectSpread2.default)((0,_objectSpread2.default)({},currentRule),{},{ruleIndex});originValidatorFunc&&(currentRule.validator=
function(rule,val,callback){var hasPromise=!1;hasPromise=(rule=originValidatorFunc(rule,val,function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];Promise.resolve().then(function(){(0,_warning.default)(!hasPromise,"Your validator function has already return a promise. `callback` will be ignored.");hasPromise||callback.apply(void 0,args)})}))&&"function"===typeof rule.then&&"function"===typeof rule.catch;(0,_warning.default)(hasPromise,"`callback` is deprecated. Please return a promise instead.");
hasPromise&&rule.then(function(){callback()}).catch(function(err){callback(err||" ")})});return currentRule}).sort(function(_ref,_ref2){var w1=_ref.warningOnly;_ref=_ref.ruleIndex;var i2=_ref2.ruleIndex;return!!w1===!!_ref2.warningOnly?_ref-i2:w1?1:-1});!0===validateFirst?validateFirst=new Promise(function(){var _ref3=(0,_asyncToGenerator2.default)((0,_regeneratorRuntime2.default)().mark(function _callee(resolve,reject){var i,rule,errors;return(0,_regeneratorRuntime2.default)().wrap(function(_context){for(;;)switch(_context.prev=
_context.next){case 0:i=0;case 1:if(!(i<filledRules.length)){_context.next=12;break}rule=filledRules[i];_context.next=5;return validateRule(name,value,rule,options,messageVariables);case 5:errors=_context.sent;if(!errors.length){_context.next=9;break}reject([{errors,rule}]);return _context.abrupt("return");case 9:i+=1;_context.next=1;break;case 12:resolve([]);case 13:case "end":return _context.stop()}},_callee)}));return function(_x6,_x7){return _ref3.apply(this,arguments)}}()):(namePath=filledRules.map(function(rule){return validateRule(name,
value,rule,options,messageVariables).then(function(errors){return{errors,rule}})}),validateFirst=(validateFirst?finishOnFirstFailed(namePath):finishOnAllFailed(namePath)).then(function(errors){return Promise.reject(errors)}));validateFirst.catch(function(e){return e});return validateFirst};var _toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_regeneratorRuntime2=
module(require("module$node_modules$$babel$runtime$helpers$regeneratorRuntime")),_objectSpread2=module(require("module$node_modules$$babel$runtime$helpers$objectSpread2")),_asyncToGenerator2=module(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator"));exports=module(require("module$node_modules$$rc_component$async_validator$lib$index"));var React=global(require("module$node_modules$react$index")),_warning=module(require("module$node_modules$rc_util$lib$warning")),_messages=require("module$node_modules$rc_field_form$lib$utils$messages"),
_set=require("module$node_modules$rc_util$lib$utils$set"),AsyncValidator=exports.default,CODE_LOGIC_ERROR="CODE_LOGIC_ERROR"}
//# sourceMappingURL=module$node_modules$rc_field_form$lib$utils$validateUtil.js.map
