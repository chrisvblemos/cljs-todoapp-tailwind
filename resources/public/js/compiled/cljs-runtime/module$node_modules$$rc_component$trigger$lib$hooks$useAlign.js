shadow$provide.module$node_modules$$rc_component$trigger$lib$hooks$useAlign=function(global,require,module,exports){function getUnitOffset(size){var offsetStr="".concat(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0),cells=offsetStr.match(/^(.*)%$/);return cells?size*(parseFloat(cells[1])/100):parseFloat(offsetStr)}function getNumberOffset(rect,offset){offset=(0,_slicedToArray2.default)(offset||[],2);var offsetY=offset[1];return[getUnitOffset(rect.width,offset[0]),getUnitOffset(rect.height,
offsetY)]}function splitPoints(){var points=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return[points[0],points[1]]}function getAlignPoint(rect,points){var topBottom=points[0];points=points[1];return{x:"l"===points?rect.x:"r"===points?rect.x+rect.width:rect.x+rect.width/2,y:"t"===topBottom?rect.y:"b"===topBottom?rect.y+rect.height:rect.y+rect.height/2}}function reversePoints(points,index){var reverseMap={t:"b",b:"t",l:"r",r:"l"};return points.map(function(point,i){return i===index?reverseMap[point]||
"c":point}).join("")}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard").default;module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault").default;Object.defineProperty(exports,"__esModule",{value:!0});exports.default=function(open,popupEle,target,placement,builtinPlacements,popupAlign,onPopupAlign){var _React$useState=React.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:builtinPlacements[placement]||
{}});_React$useState=(0,_slicedToArray2.default)(_React$useState,2);var offsetInfo=_React$useState[0],setOffsetInfo=_React$useState[1],alignCountRef=React.useRef(0),scrollerList=React.useMemo(function(){return popupEle?(0,_util.collectScroller)(popupEle):[]},[popupEle]),prevFlipRef=React.useRef({});open||(prevFlipRef.current={});var onAlign=(0,_useEvent.default)(function(){if(popupEle&&target&&open){var _popupElement$parentE,_popupRect$x,_popupRect$y,_popupElement$parentE2,doc=popupEle.ownerDocument,
_win$getComputedStyle=(0,_util.getWin)(popupEle).getComputedStyle(popupEle),width=_win$getComputedStyle.width,height=_win$getComputedStyle.height;_win$getComputedStyle=_win$getComputedStyle.position;var originLeft=popupEle.style.left,originTop=popupEle.style.top,originRight=popupEle.style.right,originBottom=popupEle.style.bottom,originOverflow=popupEle.style.overflow,placementInfo=(0,_objectSpread2.default)((0,_objectSpread2.default)({},builtinPlacements[placement]),popupAlign),placeholderElement=
doc.createElement("div");null===(_popupElement$parentE=popupEle.parentElement)||void 0===_popupElement$parentE||_popupElement$parentE.appendChild(placeholderElement);placeholderElement.style.left="".concat(popupEle.offsetLeft,"px");placeholderElement.style.top="".concat(popupEle.offsetTop,"px");placeholderElement.style.position=_win$getComputedStyle;placeholderElement.style.height="".concat(popupEle.offsetHeight,"px");placeholderElement.style.width="".concat(popupEle.offsetWidth,"px");popupEle.style.left=
"0";popupEle.style.top="0";popupEle.style.right="auto";popupEle.style.bottom="auto";popupEle.style.overflow="hidden";if(Array.isArray(target))var targetRect={x:target[0],y:target[1],width:0,height:0};else{var _rect$y;_popupElement$parentE=target.getBoundingClientRect();_popupElement$parentE.x=null!==(targetRect=_popupElement$parentE.x)&&void 0!==targetRect?targetRect:_popupElement$parentE.left;_popupElement$parentE.y=null!==(_rect$y=_popupElement$parentE.y)&&void 0!==_rect$y?_rect$y:_popupElement$parentE.top;
targetRect={x:_popupElement$parentE.x,y:_popupElement$parentE.y,width:_popupElement$parentE.width,height:_popupElement$parentE.height}}var popupRect=popupEle.getBoundingClientRect();popupRect.x=null!==(_popupRect$x=popupRect.x)&&void 0!==_popupRect$x?_popupRect$x:popupRect.left;popupRect.y=null!==(_popupRect$y=popupRect.y)&&void 0!==_popupRect$y?_popupRect$y:popupRect.top;_rect$y=doc.documentElement;_popupElement$parentE=_rect$y.scrollTop;_win$getComputedStyle=_rect$y.scrollLeft;var popupHeight=popupRect.height,
popupWidth=popupRect.width;_popupRect$x=targetRect.height;_popupRect$y=targetRect.width;doc={left:0,top:0,right:_rect$y.clientWidth,bottom:_rect$y.clientHeight};_popupElement$parentE={left:-_win$getComputedStyle,top:-_popupElement$parentE,right:_rect$y.scrollWidth-_win$getComputedStyle,bottom:_rect$y.scrollHeight-_popupElement$parentE};_win$getComputedStyle=placementInfo.htmlRegion;"scroll"!==_win$getComputedStyle&&"visibleFirst"!==_win$getComputedStyle&&(_win$getComputedStyle="visible");_rect$y=
"visibleFirst"===_win$getComputedStyle;var scrollRegionArea=(0,_util.getVisibleArea)(_popupElement$parentE,scrollerList);_popupElement$parentE=(0,_util.getVisibleArea)(doc,scrollerList);var visibleArea="visible"===_win$getComputedStyle?_popupElement$parentE:scrollRegionArea;_win$getComputedStyle=_rect$y?_popupElement$parentE:visibleArea;popupEle.style.left="auto";popupEle.style.top="auto";popupEle.style.right="0";popupEle.style.bottom="0";doc=popupEle.getBoundingClientRect();popupEle.style.left=originLeft;
popupEle.style.top=originTop;popupEle.style.right=originRight;popupEle.style.bottom=originBottom;popupEle.style.overflow=originOverflow;null===(_popupElement$parentE2=popupEle.parentElement)||void 0===_popupElement$parentE2||_popupElement$parentE2.removeChild(placeholderElement);_popupElement$parentE2=(0,_util.toNum)(Math.round(popupWidth/parseFloat(width)*1E3)/1E3);height=(0,_util.toNum)(Math.round(popupHeight/parseFloat(height)*1E3)/1E3);if(0!==_popupElement$parentE2&&0!==height&&(!(0,_findDOMNode.isDOM)(target)||
(0,_isVisible.default)(target))){function syncNextPopupPosition(){nextPopupY=popupRect.y+nextOffsetY;nextPopupBottom=nextPopupY+popupHeight;nextPopupX=popupRect.x+nextOffsetX;nextPopupRight=nextPopupX+popupWidth}function getIntersectionVisibleArea(offsetX,offsetY){var area=2<arguments.length&&void 0!==arguments[2]?arguments[2]:visibleArea,l=popupRect.x+offsetX,t=popupRect.y+offsetY;return Math.max(0,(Math.min(l+popupWidth,area.right)-Math.max(l,area.left))*(Math.min(t+popupHeight,area.bottom)-Math.max(t,
area.top)))}width=placementInfo.targetOffset;originLeft=getNumberOffset(popupRect,placementInfo.offset);originTop=(0,_slicedToArray2.default)(originLeft,2);originLeft=originTop[0];originTop=originTop[1];width=getNumberOffset(targetRect,width);width=(0,_slicedToArray2.default)(width,2);originRight=width[1];targetRect.x-=width[0];targetRect.y-=originRight;originRight=(0,_slicedToArray2.default)(placementInfo.points||[],2);width=originRight[0];originRight=splitPoints(originRight[1]);originBottom=splitPoints(width);
originOverflow=getAlignPoint(targetRect,originRight);placeholderElement=getAlignPoint(popupRect,originBottom);width=(0,_objectSpread2.default)({},placementInfo);var nextOffsetX=originOverflow.x-placeholderElement.x+originLeft,nextOffsetY=originOverflow.y-placeholderElement.y+originTop;originOverflow=getIntersectionVisibleArea(nextOffsetX,nextOffsetY);placeholderElement=getIntersectionVisibleArea(nextOffsetX,nextOffsetY,_popupElement$parentE);var targetAlignPointTL=getAlignPoint(targetRect,["t","l"]),
popupAlignPointTL=getAlignPoint(popupRect,["t","l"]),targetAlignPointBR=getAlignPoint(targetRect,["b","r"]),popupAlignPointBR=getAlignPoint(popupRect,["b","r"]);scrollRegionArea=placementInfo.overflow||{};var adjustX=scrollRegionArea.adjustX,adjustY=scrollRegionArea.adjustY;placementInfo=scrollRegionArea.shiftX;scrollRegionArea=scrollRegionArea.shiftY;var nextPopupY,nextPopupBottom,nextPopupX,nextPopupRight;syncNextPopupPosition();adjustY="boolean"===typeof adjustY?adjustY:0<=adjustY;var sameTB=originBottom[0]===
originRight[0];if(adjustY&&"t"===originBottom[0]&&(nextPopupBottom>_win$getComputedStyle.bottom||prevFlipRef.current.bt)){var tmpNextOffsetY=sameTB?nextOffsetY-(popupHeight-_popupRect$x):targetAlignPointTL.y-popupAlignPointBR.y-originTop;var newVisibleArea=getIntersectionVisibleArea(nextOffsetX,tmpNextOffsetY),newVisibleRecommendArea=getIntersectionVisibleArea(nextOffsetX,tmpNextOffsetY,_popupElement$parentE);newVisibleArea>originOverflow||newVisibleArea===originOverflow&&(!_rect$y||newVisibleRecommendArea>=
placeholderElement)?(prevFlipRef.current.bt=!0,nextOffsetY=tmpNextOffsetY,originTop=-originTop,width.points=[reversePoints(originBottom,0),reversePoints(originRight,0)]):prevFlipRef.current.bt=!1}adjustY&&"b"===originBottom[0]&&(nextPopupY<_win$getComputedStyle.top||prevFlipRef.current.tb)&&(adjustY=sameTB?nextOffsetY+(popupHeight-_popupRect$x):targetAlignPointBR.y-popupAlignPointTL.y-originTop,sameTB=getIntersectionVisibleArea(nextOffsetX,adjustY),tmpNextOffsetY=getIntersectionVisibleArea(nextOffsetX,
adjustY,_popupElement$parentE),sameTB>originOverflow||sameTB===originOverflow&&(!_rect$y||tmpNextOffsetY>=placeholderElement)?(prevFlipRef.current.tb=!0,nextOffsetY=adjustY,originTop=-originTop,width.points=[reversePoints(originBottom,0),reversePoints(originRight,0)]):prevFlipRef.current.tb=!1);adjustX="boolean"===typeof adjustX?adjustX:0<=adjustX;adjustY=originBottom[1]===originRight[1];adjustX&&"l"===originBottom[1]&&(nextPopupRight>_win$getComputedStyle.right||prevFlipRef.current.rl)&&(targetAlignPointTL=
adjustY?nextOffsetX-(popupWidth-_popupRect$y):targetAlignPointTL.x-popupAlignPointBR.x-originLeft,popupAlignPointBR=getIntersectionVisibleArea(targetAlignPointTL,nextOffsetY),sameTB=getIntersectionVisibleArea(targetAlignPointTL,nextOffsetY,_popupElement$parentE),popupAlignPointBR>originOverflow||popupAlignPointBR===originOverflow&&(!_rect$y||sameTB>=placeholderElement)?(prevFlipRef.current.rl=!0,nextOffsetX=targetAlignPointTL,originLeft=-originLeft,width.points=[reversePoints(originBottom,1),reversePoints(originRight,
1)]):prevFlipRef.current.rl=!1);adjustX&&"r"===originBottom[1]&&(nextPopupX<_win$getComputedStyle.left||prevFlipRef.current.lr)&&(_win$getComputedStyle=adjustY?nextOffsetX+(popupWidth-_popupRect$y):targetAlignPointBR.x-popupAlignPointTL.x-originLeft,popupAlignPointTL=getIntersectionVisibleArea(_win$getComputedStyle,nextOffsetY),targetAlignPointBR=getIntersectionVisibleArea(_win$getComputedStyle,nextOffsetY,_popupElement$parentE),popupAlignPointTL>originOverflow||popupAlignPointTL===originOverflow&&
(!_rect$y||targetAlignPointBR>=placeholderElement)?(prevFlipRef.current.lr=!0,nextOffsetX=_win$getComputedStyle,originLeft=-originLeft,width.points=[reversePoints(originBottom,1),reversePoints(originRight,1)]):prevFlipRef.current.lr=!1);syncNextPopupPosition();_rect$y=!0===placementInfo?0:placementInfo;"number"===typeof _rect$y&&(nextPopupX<_popupElement$parentE.left&&(nextOffsetX-=nextPopupX-_popupElement$parentE.left-originLeft,targetRect.x+_popupRect$y<_popupElement$parentE.left+_rect$y&&(nextOffsetX+=
targetRect.x-_popupElement$parentE.left+_popupRect$y-_rect$y)),nextPopupRight>_popupElement$parentE.right&&(nextOffsetX-=nextPopupRight-_popupElement$parentE.right-originLeft,targetRect.x>_popupElement$parentE.right-_rect$y&&(nextOffsetX+=targetRect.x-_popupElement$parentE.right+_rect$y)));_rect$y=!0===scrollRegionArea?0:scrollRegionArea;"number"===typeof _rect$y&&(nextPopupY<_popupElement$parentE.top&&(nextOffsetY-=nextPopupY-_popupElement$parentE.top-originTop,targetRect.y+_popupRect$x<_popupElement$parentE.top+
_rect$y&&(nextOffsetY+=targetRect.y-_popupElement$parentE.top+_popupRect$x-_rect$y)),nextPopupBottom>_popupElement$parentE.bottom&&(nextOffsetY-=nextPopupBottom-_popupElement$parentE.bottom-originTop,targetRect.y>_popupElement$parentE.bottom-_rect$y&&(nextOffsetY+=targetRect.y-_popupElement$parentE.bottom+_rect$y)));_popupElement$parentE=popupRect.x+nextOffsetX;_rect$y=popupRect.y+nextOffsetY;_win$getComputedStyle=targetRect.x;targetRect=targetRect.y;_popupRect$y=(Math.max(_popupElement$parentE,_win$getComputedStyle)+
Math.min(_popupElement$parentE+popupWidth,_win$getComputedStyle+_popupRect$y))/2-_popupElement$parentE;targetRect=(Math.max(_rect$y,targetRect)+Math.min(_rect$y+popupHeight,targetRect+_popupRect$x))/2-_rect$y;null===onPopupAlign||void 0===onPopupAlign||onPopupAlign(popupEle,width);_popupRect$x=doc.right-popupRect.x-(nextOffsetX+popupRect.width);doc=doc.bottom-popupRect.y-(nextOffsetY+popupRect.height);1===_popupElement$parentE2&&(nextOffsetX=Math.round(nextOffsetX),_popupRect$x=Math.round(_popupRect$x));
1===height&&(nextOffsetY=Math.round(nextOffsetY),doc=Math.round(doc));setOffsetInfo({ready:!0,offsetX:nextOffsetX/_popupElement$parentE2,offsetY:nextOffsetY/height,offsetR:_popupRect$x/_popupElement$parentE2,offsetB:doc/height,arrowX:_popupRect$y/_popupElement$parentE2,arrowY:targetRect/height,scaleX:_popupElement$parentE2,scaleY:height,align:width})}}}),resetReady=function(){setOffsetInfo(function(ori){return(0,_objectSpread2.default)((0,_objectSpread2.default)({},ori),{},{ready:!1})})};(0,_useLayoutEffect.default)(resetReady,
[placement]);(0,_useLayoutEffect.default)(function(){open||resetReady()},[open]);return[offsetInfo.ready,offsetInfo.offsetX,offsetInfo.offsetY,offsetInfo.offsetR,offsetInfo.offsetB,offsetInfo.arrowX,offsetInfo.arrowY,offsetInfo.scaleX,offsetInfo.scaleY,offsetInfo.align,function(){alignCountRef.current+=1;var id=alignCountRef.current;Promise.resolve().then(function(){alignCountRef.current===id&&onAlign()})}]};var _objectSpread2=module(require("module$node_modules$$babel$runtime$helpers$objectSpread2")),
_slicedToArray2=module(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_findDOMNode=require("module$node_modules$rc_util$lib$Dom$findDOMNode"),_isVisible=module(require("module$node_modules$rc_util$lib$Dom$isVisible")),_useEvent=module(require("module$node_modules$rc_util$lib$hooks$useEvent")),_useLayoutEffect=module(require("module$node_modules$rc_util$lib$hooks$useLayoutEffect")),React=global(require("module$node_modules$react$index")),_util=require("module$node_modules$$rc_component$trigger$lib$util")}
//# sourceMappingURL=module$node_modules$$rc_component$trigger$lib$hooks$useAlign.js.map
