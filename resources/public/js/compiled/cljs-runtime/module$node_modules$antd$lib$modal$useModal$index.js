shadow$provide.module$node_modules$antd$lib$modal$useModal$index=function(global,require,module,exports){"use client";global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard").default;module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault").default;Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),React=global(require("module$node_modules$react$index")),
_usePatchElement=module(require("module$node_modules$antd$lib$_util$hooks$usePatchElement")),_confirm=require("module$node_modules$antd$lib$modal$confirm"),_destroyFns=module(require("module$node_modules$antd$lib$modal$destroyFns")),_HookModal=module(require("module$node_modules$antd$lib$modal$useModal$HookModal"));let uuid=0;const ElementsHolder=React.memo(React.forwardRef((_props,ref)=>{const [elements,patchElement]=(0,_usePatchElement.default)();React.useImperativeHandle(ref,()=>({patchElement}),
[]);return React.createElement(React.Fragment,null,elements)}));exports.default=function(){const holderRef=React.useRef(null),[actionQueue,setActionQueue]=React.useState([]);React.useEffect(()=>{actionQueue.length&&((0,_toConsumableArray2.default)(actionQueue).forEach(action=>{action()}),setActionQueue([]))},[actionQueue]);const getConfirmFunc=React.useCallback(withFunc=>function(config){var _a;uuid+=1;const modalRef=React.createRef();let resolvePromise;const promise=new Promise(resolve=>{resolvePromise=
resolve});let silent=!1,closeFunc;config=React.createElement(_HookModal.default,{key:`modal-${uuid}`,config:withFunc(config),ref:modalRef,afterClose:()=>{null===closeFunc||void 0===closeFunc?void 0:closeFunc()},isSilent:()=>silent,onConfirm:confirmed=>{resolvePromise(confirmed)}});(closeFunc=null===(_a=holderRef.current)||void 0===_a?void 0:_a.patchElement(config))&&_destroyFns.default.push(closeFunc);return{destroy:()=>{function destroyAction(){var _a;null===(_a=modalRef.current)||void 0===_a?void 0:
_a.destroy()}modalRef.current?destroyAction():setActionQueue(prev=>[].concat((0,_toConsumableArray2.default)(prev),[destroyAction]))},update:newConfig=>{function updateAction(){var _a;null===(_a=modalRef.current)||void 0===_a?void 0:_a.update(newConfig)}modalRef.current?updateAction():setActionQueue(prev=>[].concat((0,_toConsumableArray2.default)(prev),[updateAction]))},then:resolve=>{silent=!0;return promise.then(resolve)}}},[]);return[React.useMemo(()=>({info:getConfirmFunc(_confirm.withInfo),success:getConfirmFunc(_confirm.withSuccess),
error:getConfirmFunc(_confirm.withError),warning:getConfirmFunc(_confirm.withWarn),confirm:getConfirmFunc(_confirm.withConfirm)}),[]),React.createElement(ElementsHolder,{key:"modal-holder",ref:holderRef})]}}
//# sourceMappingURL=module$node_modules$antd$lib$modal$useModal$index.js.map
