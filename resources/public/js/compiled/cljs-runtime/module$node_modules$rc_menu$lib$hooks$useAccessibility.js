shadow$provide.module$node_modules$rc_menu$lib$hooks$useAccessibility=function(global,require,module,exports){function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function getOffset(mode,isRootLevel,isRtl,which){var _offsets;if("inline"===mode&&which===ENTER)return{inlineTrigger:!0};var inline=(0,_defineProperty2.default)((0,_defineProperty2.default)({},UP,"prev"),DOWN,"next"),horizontal=
(0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)({},LEFT,isRtl?"next":"prev"),RIGHT,isRtl?"prev":"next"),DOWN,"children"),ENTER,"children");isRtl=(0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)({},UP,"prev"),DOWN,"next"),ENTER,"children"),ESC,"parent"),LEFT,isRtl?"children":"parent"),RIGHT,isRtl?"parent":"children");
switch(null===(_offsets={inline,horizontal,vertical:isRtl,inlineSub:inline,horizontalSub:isRtl,verticalSub:isRtl}["".concat(mode).concat(isRootLevel?"":"Sub")])||void 0===_offsets?void 0:_offsets[which]){case "prev":return{offset:-1,sibling:!0};case "next":return{offset:1,sibling:!0};case "parent":return{offset:-1,sibling:!1};case "children":return{offset:1,sibling:!1};default:return null}}function findContainerUL(element){for(;element;){if(element.getAttribute("data-menu-list"))return element;element=
element.parentElement}return null}function getFocusElement(activeElement,elements){for(activeElement=activeElement||document.activeElement;activeElement;){if(elements.has(activeElement))return activeElement;activeElement=activeElement.parentElement}return null}function getFocusableElements(container,elements){return(0,_focus.getFocusNodeList)(container,!0).filter(function(ele){return elements.has(ele)})}function getNextFocusElement(parentQueryContainer,elements,focusMenuElement){var offset=3<arguments.length&&
void 0!==arguments[3]?arguments[3]:1;if(!parentQueryContainer)return null;var sameLevelFocusableMenuElementList=getFocusableElements(parentQueryContainer,elements),count=sameLevelFocusableMenuElementList.length,focusIndex=sameLevelFocusableMenuElementList.findIndex(function(ele){return focusMenuElement===ele});0>offset?focusIndex=-1===focusIndex?count-1:focusIndex-1:0<offset&&(focusIndex+=1);return sameLevelFocusableMenuElementList[(focusIndex+count)%count]}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");
var _typeof=require("module$node_modules$$babel$runtime$helpers$typeof");Object.defineProperty(exports,"__esModule",{value:!0});exports.getFocusableElements=getFocusableElements;exports.refreshElements=void 0;exports.useAccessibility=function(mode,activeKey,isRtl,id,containerRef,getKeys,getKeyPath,triggerActiveKey,triggerAccessibilityOpen,originOnKeyDown){var rafRef=React.useRef(),activeRef=React.useRef();activeRef.current=activeKey;var cleanRaf=function(){_raf.default.cancel(rafRef.current)};React.useEffect(function(){return function(){cleanRaf()}},
[]);return function(e){var which=e.which;if([].concat(ArrowKeys,[ENTER,ESC,HOME,END]).includes(which)){var keys=getKeys(),refreshedElements=refreshElements(keys,id),_refreshedElements=refreshedElements,elements=_refreshedElements.elements,key2element=_refreshedElements.key2element,element2key=_refreshedElements.element2key;_refreshedElements=key2element.get(activeKey);var focusMenuElement=getFocusElement(_refreshedElements,elements),focusMenuKey=element2key.get(focusMenuElement);_refreshedElements=
getOffset(mode,1===getKeyPath(focusMenuKey,!0).length,isRtl,which);if(!_refreshedElements&&which!==HOME&&which!==END)return;(ArrowKeys.includes(which)||[HOME,END].includes(which))&&e.preventDefault();var tryFocus=function(menuElement){if(menuElement){var focusTargetElement=menuElement,link=menuElement.querySelector("a");null!==link&&void 0!==link&&link.getAttribute("href")&&(focusTargetElement=link);var targetKey=element2key.get(menuElement);triggerActiveKey(targetKey);cleanRaf();rafRef.current=(0,_raf.default)(function(){activeRef.current===
targetKey&&focusTargetElement.focus()})}};[HOME,END].includes(which)||_refreshedElements.sibling||!focusMenuElement?(key2element=focusMenuElement&&"inline"!==mode?findContainerUL(focusMenuElement):containerRef.current,focusMenuKey=getFocusableElements(key2element,elements),which=which===HOME?focusMenuKey[0]:which===END?focusMenuKey[focusMenuKey.length-1]:getNextFocusElement(key2element,elements,focusMenuElement,_refreshedElements.offset),tryFocus(which)):_refreshedElements.inlineTrigger?triggerAccessibilityOpen(focusMenuKey):
0<_refreshedElements.offset?(triggerAccessibilityOpen(focusMenuKey,!0),cleanRaf(),rafRef.current=(0,_raf.default)(function(){refreshedElements=refreshElements(keys,id);var controlId=focusMenuElement.getAttribute("aria-controls");controlId=document.getElementById(controlId);controlId=getNextFocusElement(controlId,refreshedElements.elements);tryFocus(controlId)},5)):0>_refreshedElements.offset&&(which=getKeyPath(focusMenuKey,!0),which=which[which.length-2],elements=key2element.get(which),triggerAccessibilityOpen(which,
!1),tryFocus(elements))}null===originOnKeyDown||void 0===originOnKeyDown||originOnKeyDown(e)}};var _defineProperty2=global(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_focus=require("module$node_modules$rc_util$lib$Dom$focus");module=global(require("module$node_modules$rc_util$lib$KeyCode"));var _raf=global(require("module$node_modules$rc_util$lib$raf")),React=function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};
if((r=_getRequireWildcardCache(r))&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor,u;for(u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}(require("module$node_modules$react$index")),_IdContext=require("module$node_modules$rc_menu$lib$context$IdContext"),LEFT=module.default.LEFT,RIGHT=
module.default.RIGHT,UP=module.default.UP,DOWN=module.default.DOWN,ENTER=module.default.ENTER,ESC=module.default.ESC,HOME=module.default.HOME,END=module.default.END,ArrowKeys=[UP,DOWN,LEFT,RIGHT],refreshElements=exports.refreshElements=function(keys,id){var elements=new Set,key2element=new Map,element2key=new Map;keys.forEach(function(key){var element=document.querySelector("[data-menu-id\x3d'".concat((0,_IdContext.getMenuId)(id,key),"']"));element&&(elements.add(element),element2key.set(element,
key),key2element.set(key,element))});return{elements,key2element,element2key}}}
//# sourceMappingURL=module$node_modules$rc_menu$lib$hooks$useAccessibility.js.map
