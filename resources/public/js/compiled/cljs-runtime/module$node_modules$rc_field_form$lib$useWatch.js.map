{
"version":3,
"file":"module$node_modules$rc_field_form$lib$useWatch.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/rc-field-form/lib/useWatch.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$rc_field_form$lib$useWatch\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nexports.stringify = stringify;\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _warning = _interopRequireDefault(require(\"rc-util/lib/warning\"));\nvar _react = require(\"react\");\nvar _FieldContext = _interopRequireWildcard(require(\"./FieldContext\"));\nvar _typeUtil = require(\"./utils/typeUtil\");\nvar _valueUtil = require(\"./utils/valueUtil\");\nfunction stringify(value) {\n  try {\n    return JSON.stringify(value);\n  } catch (err) {\n    return Math.random();\n  }\n}\nvar useWatchWarning = process.env.NODE_ENV !== 'production' ? function (namePath) {\n  var fullyStr = namePath.join('__RC_FIELD_FORM_SPLIT__');\n  var nameStrRef = (0, _react.useRef)(fullyStr);\n  (0, _warning.default)(nameStrRef.current === fullyStr, '`useWatch` is not support dynamic `namePath`. Please provide static instead.');\n} : function () {};\n\n// ------- selector type -------\n\n// ------- selector type end -------\n\nfunction useWatch() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  var dependencies = args[0],\n    _args$ = args[1],\n    _form = _args$ === void 0 ? {} : _args$;\n  var options = (0, _typeUtil.isFormInstance)(_form) ? {\n    form: _form\n  } : _form;\n  var form = options.form;\n  var _useState = (0, _react.useState)(),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  var valueStr = (0, _react.useMemo)(function () {\n    return stringify(value);\n  }, [value]);\n  var valueStrRef = (0, _react.useRef)(valueStr);\n  valueStrRef.current = valueStr;\n  var fieldContext = (0, _react.useContext)(_FieldContext.default);\n  var formInstance = form || fieldContext;\n  var isValidForm = formInstance && formInstance._init;\n\n  // Warning if not exist form instance\n  if (process.env.NODE_ENV !== 'production') {\n    (0, _warning.default)(args.length === 2 ? form ? isValidForm : true : isValidForm, 'useWatch requires a form instance since it can not auto detect from context.');\n  }\n  var namePath = (0, _valueUtil.getNamePath)(dependencies);\n  var namePathRef = (0, _react.useRef)(namePath);\n  namePathRef.current = namePath;\n  useWatchWarning(namePath);\n  (0, _react.useEffect)(function () {\n    // Skip if not exist form instance\n    if (!isValidForm) {\n      return;\n    }\n    var getFieldsValue = formInstance.getFieldsValue,\n      getInternalHooks = formInstance.getInternalHooks;\n    var _getInternalHooks = getInternalHooks(_FieldContext.HOOK_MARK),\n      registerWatch = _getInternalHooks.registerWatch;\n    var getWatchValue = function getWatchValue(values, allValues) {\n      var watchValue = options.preserve ? allValues : values;\n      return typeof dependencies === 'function' ? dependencies(watchValue) : (0, _valueUtil.getValue)(watchValue, namePathRef.current);\n    };\n    var cancelRegister = registerWatch(function (values, allValues) {\n      var newValue = getWatchValue(values, allValues);\n      var nextValueStr = stringify(newValue);\n\n      // Compare stringify in case it's nest object\n      if (valueStrRef.current !== nextValueStr) {\n        valueStrRef.current = nextValueStr;\n        setValue(newValue);\n      }\n    });\n\n    // TODO: We can improve this perf in future\n    var initialValue = getWatchValue(getFieldsValue(), getFieldsValue(true));\n\n    // React 18 has the bug that will queue update twice even the value is not changed\n    // ref: https://github.com/facebook/react/issues/27213\n    if (value !== initialValue) {\n      setValue(initialValue);\n    }\n    return cancelRegister;\n  },\n  // We do not need re-register since namePath content is the same\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [isValidForm]);\n  return value;\n}\nvar _default = exports.default = useWatch;\n};"],
"names":["shadow$provide","global","require","module","exports","stringify","value","JSON","err","Math","random","_interopRequireWildcard","default","_interopRequireDefault","Object","defineProperty","_slicedToArray2","_warning","_react","_FieldContext","_typeUtil","_valueUtil","useWatchWarning","namePath","fullyStr","join","nameStrRef","useRef","current","useWatch","_len","arguments","length","args","Array","_key","dependencies","_args$","_form","options","isFormInstance","form","_useState","useState","_useState2","setValue","valueStr","useMemo","valueStrRef","fieldContext","useContext","formInstance","isValidForm","_init","getNamePath","namePathRef","useEffect","getFieldsValue","getInternalHooks","registerWatch","_getInternalHooks","HOOK_MARK","getWatchValue","values","allValues","watchValue","preserve","getValue","cancelRegister","newValue","nextValueStr","initialValue"]
}
