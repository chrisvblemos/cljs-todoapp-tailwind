shadow$provide.module$node_modules$rc_motion$lib$hooks$useStatus=function(global,require,module,exports){function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};if((r=_getRequireWildcardCache(r))&&r.has(e))return r.get(e);var n={__proto__:null},
a=Object.defineProperty&&Object.getOwnPropertyDescriptor,u;for(u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}global=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");var _typeof=require("module$node_modules$$babel$runtime$helpers$typeof");Object.defineProperty(exports,"__esModule",{value:!0});exports.default=function(supportMotion,
visible,getElement,_ref){var _ref$motionEnter=_ref.motionEnter,motionEnter=void 0===_ref$motionEnter?!0:_ref$motionEnter;_ref$motionEnter=_ref.motionAppear;var motionAppear=void 0===_ref$motionEnter?!0:_ref$motionEnter;_ref$motionEnter=_ref.motionLeave;var motionLeave=void 0===_ref$motionEnter?!0:_ref$motionEnter,motionDeadline=_ref.motionDeadline,motionLeaveImmediately=_ref.motionLeaveImmediately,onAppearPrepare=_ref.onAppearPrepare,onEnterPrepare=_ref.onEnterPrepare,onLeavePrepare=_ref.onLeavePrepare,
onAppearStart=_ref.onAppearStart,onEnterStart=_ref.onEnterStart,onLeaveStart=_ref.onLeaveStart,onAppearActive=_ref.onAppearActive,onEnterActive=_ref.onEnterActive,onLeaveActive=_ref.onLeaveActive,onAppearEnd=_ref.onAppearEnd,onEnterEnd=_ref.onEnterEnd,onLeaveEnd=_ref.onLeaveEnd,onVisibleChanged=_ref.onVisibleChanged;_ref=(0,_useState5.default)();_ref=(0,_slicedToArray2.default)(_ref,2);var asyncVisible=_ref[0],setAsyncVisible=_ref[1];_ref=(0,_useSyncState3.default)(_interface.STATUS_NONE);_ref=(0,_slicedToArray2.default)(_ref,
2);var getStatus=_ref[0],setStatus=_ref[1];_ref=(0,_useState5.default)(null);_ref$motionEnter=(0,_slicedToArray2.default)(_ref,2);_ref=_ref$motionEnter[0];var setStyle=_ref$motionEnter[1],currentStatus=getStatus(),mountedRef=(0,_react.useRef)(!1),deadlineRef=(0,_react.useRef)(null),activeRef=(0,_react.useRef)(!1),onInternalMotionEnd=(0,_rcUtil.useEvent)(function(event){var status=getStatus();if(status!==_interface.STATUS_NONE){var element=getElement();if(!event||event.deadline||event.target===element){var currentActive=
activeRef.current,canEnd;status===_interface.STATUS_APPEAR&&currentActive?canEnd=null===onAppearEnd||void 0===onAppearEnd?void 0:onAppearEnd(element,event):status===_interface.STATUS_ENTER&&currentActive?canEnd=null===onEnterEnd||void 0===onEnterEnd?void 0:onEnterEnd(element,event):status===_interface.STATUS_LEAVE&&currentActive&&(canEnd=null===onLeaveEnd||void 0===onLeaveEnd?void 0:onLeaveEnd(element,event));currentActive&&!1!==canEnd&&(setStatus(_interface.STATUS_NONE),setStyle(null,!0))}}});_ref$motionEnter=
(0,_useDomMotionEvents3.default)(onInternalMotionEnd);var patchMotionEvents=(0,_slicedToArray2.default)(_ref$motionEnter,1)[0],getEventHandlers=function(targetStatus){switch(targetStatus){case _interface.STATUS_APPEAR:return(0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)({},_interface.STEP_PREPARE,onAppearPrepare),_interface.STEP_START,onAppearStart),_interface.STEP_ACTIVE,onAppearActive);case _interface.STATUS_ENTER:return(0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)({},
_interface.STEP_PREPARE,onEnterPrepare),_interface.STEP_START,onEnterStart),_interface.STEP_ACTIVE,onEnterActive);case _interface.STATUS_LEAVE:return(0,_defineProperty2.default)((0,_defineProperty2.default)((0,_defineProperty2.default)({},_interface.STEP_PREPARE,onLeavePrepare),_interface.STEP_START,onLeaveStart),_interface.STEP_ACTIVE,onLeaveActive);default:return{}}},eventHandlers=React.useMemo(function(){return getEventHandlers(currentStatus)},[currentStatus]);_ref$motionEnter=(0,_useStepQueue3.default)(currentStatus,
!supportMotion,function(newStep){if(newStep===_interface.STEP_PREPARE)return(newStep=eventHandlers[_interface.STEP_PREPARE])?newStep(getElement()):_useStepQueue3.SkipStep;if(step in eventHandlers){var _eventHandlers$step;setStyle((null===(_eventHandlers$step=eventHandlers[step])||void 0===_eventHandlers$step?void 0:_eventHandlers$step.call(eventHandlers,getElement(),null))||null)}step===_interface.STEP_ACTIVE&&currentStatus!==_interface.STATUS_NONE&&(patchMotionEvents(getElement()),0<motionDeadline&&
(clearTimeout(deadlineRef.current),deadlineRef.current=setTimeout(function(){onInternalMotionEnd({deadline:!0})},motionDeadline)));step===_interface.STEP_PREPARED&&(setStatus(_interface.STATUS_NONE),setStyle(null,!0));return _useStepQueue3.DoStep});_ref$motionEnter=(0,_slicedToArray2.default)(_ref$motionEnter,2);var startStep=_ref$motionEnter[0],step=_ref$motionEnter[1];_ref$motionEnter=(0,_useStepQueue3.isActive)(step);activeRef.current=_ref$motionEnter;var visibleRef=(0,_react.useRef)(null);(0,_useIsomorphicLayoutEffect.default)(function(){if(!mountedRef.current||
visibleRef.current!==visible){setAsyncVisible(visible);var isMounted=mountedRef.current;mountedRef.current=!0;if(!isMounted&&visible&&motionAppear)var nextStatus=_interface.STATUS_APPEAR;isMounted&&visible&&motionEnter&&(nextStatus=_interface.STATUS_ENTER);if(isMounted&&!visible&&motionLeave||!isMounted&&motionLeaveImmediately&&!visible&&motionLeave)nextStatus=_interface.STATUS_LEAVE;isMounted=getEventHandlers(nextStatus);nextStatus&&(supportMotion||isMounted[_interface.STEP_PREPARE])?(setStatus(nextStatus),
startStep()):setStatus(_interface.STATUS_NONE);visibleRef.current=visible}},[visible]);(0,_react.useEffect)(function(){(currentStatus===_interface.STATUS_APPEAR&&!motionAppear||currentStatus===_interface.STATUS_ENTER&&!motionEnter||currentStatus===_interface.STATUS_LEAVE&&!motionLeave)&&setStatus(_interface.STATUS_NONE)},[motionAppear,motionEnter,motionLeave]);(0,_react.useEffect)(function(){return function(){mountedRef.current=!1;clearTimeout(deadlineRef.current)}},[]);var firstMountChangeRef=React.useRef(!1);
(0,_react.useEffect)(function(){asyncVisible&&(firstMountChangeRef.current=!0);if(void 0!==asyncVisible&&currentStatus===_interface.STATUS_NONE){if(firstMountChangeRef.current||asyncVisible)null===onVisibleChanged||void 0===onVisibleChanged||onVisibleChanged(asyncVisible);firstMountChangeRef.current=!0}},[asyncVisible,currentStatus]);eventHandlers[_interface.STEP_PREPARE]&&step===_interface.STEP_START&&(_ref=(0,_objectSpread2.default)({transition:"none"},_ref));return[currentStatus,step,_ref,null!==
asyncVisible&&void 0!==asyncVisible?asyncVisible:visible]};var _objectSpread2=global(require("module$node_modules$$babel$runtime$helpers$objectSpread2")),_defineProperty2=global(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_slicedToArray2=global(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_rcUtil=require("module$node_modules$rc_util$lib$index"),_useState5=global(require("module$node_modules$rc_util$lib$hooks$useState")),_useSyncState3=global(require("module$node_modules$rc_util$lib$hooks$useSyncState")),
_react=_interopRequireWildcard(require("module$node_modules$react$index")),React=_react,_interface=require("module$node_modules$rc_motion$lib$interface"),_useDomMotionEvents3=global(require("module$node_modules$rc_motion$lib$hooks$useDomMotionEvents")),_useIsomorphicLayoutEffect=global(require("module$node_modules$rc_motion$lib$hooks$useIsomorphicLayoutEffect")),_useStepQueue3=_interopRequireWildcard(require("module$node_modules$rc_motion$lib$hooks$useStepQueue"))}
//# sourceMappingURL=module$node_modules$rc_motion$lib$hooks$useStatus.js.map
