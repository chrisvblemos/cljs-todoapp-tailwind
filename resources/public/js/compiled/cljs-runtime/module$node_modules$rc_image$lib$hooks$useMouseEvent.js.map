{
"version":3,
"file":"module$node_modules$rc_image$lib$hooks$useMouseEvent.js",
"lineCount":8,
"mappings":"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",
"sources":["node_modules/rc-image/lib/hooks/useMouseEvent.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$rc_image$lib$hooks$useMouseEvent\"] = function(global,require,module,exports) {\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = useMouseEvent;\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread2\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _addEventListener = _interopRequireDefault(require(\"rc-util/lib/Dom/addEventListener\"));\nvar _warning = require(\"rc-util/lib/warning\");\nvar _react = require(\"react\");\nvar _getFixScaleEleTransPosition = _interopRequireDefault(require(\"../getFixScaleEleTransPosition\"));\nvar _previewConfig = require(\"../previewConfig\");\nfunction useMouseEvent(imgRef, movable, visible, scaleStep, transform, updateTransform, dispatchZoomChange) {\n  var rotate = transform.rotate,\n    scale = transform.scale,\n    x = transform.x,\n    y = transform.y;\n  var _useState = (0, _react.useState)(false),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    isMoving = _useState2[0],\n    setMoving = _useState2[1];\n  var startPositionInfo = (0, _react.useRef)({\n    diffX: 0,\n    diffY: 0,\n    transformX: 0,\n    transformY: 0\n  });\n  var onMouseDown = function onMouseDown(event) {\n    // Only allow main button\n    if (!movable || event.button !== 0) return;\n    event.preventDefault();\n    event.stopPropagation();\n    startPositionInfo.current = {\n      diffX: event.pageX - x,\n      diffY: event.pageY - y,\n      transformX: x,\n      transformY: y\n    };\n    setMoving(true);\n  };\n  var onMouseMove = function onMouseMove(event) {\n    if (visible && isMoving) {\n      updateTransform({\n        x: event.pageX - startPositionInfo.current.diffX,\n        y: event.pageY - startPositionInfo.current.diffY\n      }, 'move');\n    }\n  };\n  var onMouseUp = function onMouseUp() {\n    if (visible && isMoving) {\n      setMoving(false);\n\n      /** No need to restore the position when the picture is not moved, So as not to interfere with the click */\n      var _startPositionInfo$cu = startPositionInfo.current,\n        transformX = _startPositionInfo$cu.transformX,\n        transformY = _startPositionInfo$cu.transformY;\n      var hasChangedPosition = x !== transformX && y !== transformY;\n      if (!hasChangedPosition) return;\n      var width = imgRef.current.offsetWidth * scale;\n      var height = imgRef.current.offsetHeight * scale;\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      var _imgRef$current$getBo = imgRef.current.getBoundingClientRect(),\n        left = _imgRef$current$getBo.left,\n        top = _imgRef$current$getBo.top;\n      var isRotate = rotate % 180 !== 0;\n      var fixState = (0, _getFixScaleEleTransPosition.default)(isRotate ? height : width, isRotate ? width : height, left, top);\n      if (fixState) {\n        updateTransform((0, _objectSpread2.default)({}, fixState), 'dragRebound');\n      }\n    }\n  };\n  var onWheel = function onWheel(event) {\n    if (!visible || event.deltaY == 0) return;\n    // Scale ratio depends on the deltaY size\n    var scaleRatio = Math.abs(event.deltaY / 100);\n    // Limit the maximum scale ratio\n    var mergedScaleRatio = Math.min(scaleRatio, _previewConfig.WHEEL_MAX_SCALE_RATIO);\n    // Scale the ratio each time\n    var ratio = _previewConfig.BASE_SCALE_RATIO + mergedScaleRatio * scaleStep;\n    if (event.deltaY > 0) {\n      ratio = _previewConfig.BASE_SCALE_RATIO / ratio;\n    }\n    dispatchZoomChange(ratio, 'wheel', event.clientX, event.clientY);\n  };\n  (0, _react.useEffect)(function () {\n    var onTopMouseUpListener;\n    var onTopMouseMoveListener;\n    var onMouseUpListener;\n    var onMouseMoveListener;\n    if (movable) {\n      onMouseUpListener = (0, _addEventListener.default)(window, 'mouseup', onMouseUp, false);\n      onMouseMoveListener = (0, _addEventListener.default)(window, 'mousemove', onMouseMove, false);\n      try {\n        // Resolve if in iframe lost event\n        /* istanbul ignore next */\n        if (window.top !== window.self) {\n          onTopMouseUpListener = (0, _addEventListener.default)(window.top, 'mouseup', onMouseUp, false);\n          onTopMouseMoveListener = (0, _addEventListener.default)(window.top, 'mousemove', onMouseMove, false);\n        }\n      } catch (error) {\n        /* istanbul ignore next */\n        (0, _warning.warning)(false, \"[rc-image] \".concat(error));\n      }\n    }\n    return function () {\n      var _onMouseUpListener, _onMouseMoveListener, _onTopMouseUpListener, _onTopMouseMoveListen;\n      (_onMouseUpListener = onMouseUpListener) === null || _onMouseUpListener === void 0 || _onMouseUpListener.remove();\n      (_onMouseMoveListener = onMouseMoveListener) === null || _onMouseMoveListener === void 0 || _onMouseMoveListener.remove();\n      /* istanbul ignore next */\n      (_onTopMouseUpListener = onTopMouseUpListener) === null || _onTopMouseUpListener === void 0 || _onTopMouseUpListener.remove();\n      /* istanbul ignore next */\n      (_onTopMouseMoveListen = onTopMouseMoveListener) === null || _onTopMouseMoveListen === void 0 || _onTopMouseMoveListen.remove();\n    };\n  }, [visible, isMoving, x, y, rotate, movable]);\n  return {\n    isMoving: isMoving,\n    onMouseDown: onMouseDown,\n    onMouseMove: onMouseMove,\n    onMouseUp: onMouseUp,\n    onWheel: onWheel\n  };\n}\n};"],
"names":["shadow$provide","global","require","module","exports","_interopRequireDefault","Object","defineProperty","value","default","useMouseEvent","imgRef","movable","visible","scaleStep","transform","updateTransform","dispatchZoomChange","rotate","scale","x","y","_useState","_react","useState","_useState2","_slicedToArray2","isMoving","setMoving","startPositionInfo","useRef","diffX","diffY","transformX","transformY","onMouseMove","event","pageX","current","pageY","onMouseUp","_startPositionInfo$cu","width","offsetWidth","height","offsetHeight","_imgRef$current$getBo","getBoundingClientRect","isRotate","fixState","_getFixScaleEleTransPosition","left","top","_objectSpread2","useEffect","onMouseUpListener","_addEventListener","window","onMouseMoveListener","self","onTopMouseUpListener","onTopMouseMoveListener","error","_warning","warning","concat","_onMouseUpListener","_onMouseMoveListener","_onTopMouseUpListener","_onTopMouseMoveListen","remove","onMouseDown","button","preventDefault","stopPropagation","onWheel","deltaY","ratio","_previewConfig","BASE_SCALE_RATIO","Math","min","mergedScaleRatio","abs","scaleRatio","WHEEL_MAX_SCALE_RATIO","clientX","clientY"]
}
